classDiagram
    %% --- Core System ---
    class CanvasContext {
        +CanvasEngine engine
        +ConfigsManager configs
        +initialize()
    }
    class CanvasEngine {
        -ViewportManager viewport
        -CoordinateSystem coords
        -EventBus eventBus
        +loadGraph()
        +startDrag()
    }

    %% --- Configuration ---
    class ConfigsManager {
        +ViewportConfig
        +ThemeConfig
        +UIConfig
        +subscribe()
    }

    %% --- Events ---
    class EventBus {
        +on()
        +emit()
    }

    %% --- Viewport ---
    class ViewportManager {
        +x, y, zoom
        +setViewport()
        +screenToWorld()
    }

    %% --- Plugin System ---
    class BasePlugin {
        <<Abstract>>
        +initialize()
        +activate()
        +render()
    }
    class NodeLayerPlugin {
        +render()
    }
    class GridPlugin {
        +render()
    }
    class MinimapPlugin {
        +render()
    }
    class ToolbarPlugin {
        +render()
    }
    class NodePickerPlugin {
        +render()
    }

    %% --- React Layer ---
    class ReactComponents {
        CanvasContainer
        App
    }

    %% --- Relationships ---
    CanvasContext *-- CanvasEngine
    CanvasContext *-- ConfigsManager
    CanvasEngine *-- ViewportManager
    CanvasEngine *-- EventBus
    ViewportManager ..> EventBus

    BasePlugin <|-- NodeLayerPlugin
    BasePlugin <|-- GridPlugin
    BasePlugin <|-- MinimapPlugin
    BasePlugin <|-- ToolbarPlugin
    BasePlugin <|-- NodePickerPlugin
    
    CanvasContext o-- BasePlugin
    ReactComponents ..> CanvasEngine

    %% --- Styling Definitions ---
    classDef core fill:#E8F4FF,stroke:#2C77F4,stroke-width:2px,color:#000
    classDef config fill:#E8FFE8,stroke:#2CA02C,stroke-width:2px,color:#000
    classDef event fill:#FFF9E6,stroke:#D4A017,stroke-width:2px,color:#000
    classDef viewport fill:#FFF2E8,stroke:#FF7F0E,stroke-width:2px,color:#000
    classDef plugin fill:#F5E8FF,stroke:#8E44AD,stroke-width:2px,color:#000
    classDef react fill:#F6F6F6,stroke:#666666,stroke-width:2px,color:#000
    classDef abstract fill:#FFFFFF,stroke:#333,stroke-width:1px,stroke-dasharray: 5 5

    %% --- Applying Colors ---
    class CanvasContext core
    class CanvasEngine core
    
    class ConfigsManager config
    
    class EventBus event
    
    class ViewportManager viewport
    
    class BasePlugin abstract
    class NodeLayerPlugin plugin
    class GridPlugin plugin
    class MinimapPlugin plugin
    class ToolbarPlugin plugin
    class NodePickerPlugin plugin
    
    class ReactComponents react
