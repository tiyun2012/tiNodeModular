classDiagram
    direction LR

    %% --- Styles for Dark Mode Visibility ---
    %% High contrast strokes (white/bright) and distinct fills
    classDef core fill:#0284c7,stroke:#38bdf8,stroke-width:3px,color:#fff
    classDef config fill:#16a34a,stroke:#4ade80,stroke-width:2px,color:#fff
    classDef event fill:#d97706,stroke:#fcd34d,stroke-width:2px,color:#fff
    classDef viewport fill:#9333ea,stroke:#c084fc,stroke-width:2px,color:#fff
    classDef plugin fill:#be185d,stroke:#f472b6,stroke-width:2px,color:#fff
    classDef react fill:#334155,stroke:#94a3b8,stroke-width:2px,color:#fff
    classDef abstract fill:#000,stroke:#fff,stroke-width:1px,stroke-dasharray: 5 5,color:#fff

    %% --- React Layer (Entry Point) ---
    class ReactComponents {
        CanvasContainer
        App
    }
    class ReactComponents react

    %% --- Core System ---
    class CanvasContext {
        +CanvasEngine engine
        +ConfigsManager configs
        +initialize()
    }
    class CanvasContext core

    class CanvasEngine {
        -ViewportManager viewport
        -CoordinateSystem coords
        -EventBus eventBus
        +loadGraph()
        +startDrag()
    }
    class CanvasEngine core

    %% --- Configuration ---
    class ConfigsManager {
        +ViewportConfig
        +ThemeConfig
        +UIConfig
        +subscribe()
    }
    class ConfigsManager config

    %% --- Events ---
    class EventBus {
        +on()
        +emit()
    }
    class EventBus event

    %% --- Viewport ---
    class ViewportManager {
        +x, y, zoom
        +setViewport()
        +screenToWorld()
    }
    class ViewportManager viewport

    %% --- Plugin System ---
    class BasePlugin {
        <<Abstract>>
        +initialize()
        +activate()
        +render()
    }
    class BasePlugin abstract

    class NodeLayerPlugin {
        +render()
    }
    class NodeLayerPlugin plugin

    class GridPlugin {
        +render()
    }
    class GridPlugin plugin

    class MinimapPlugin {
        +render()
    }
    class MinimapPlugin plugin

    class ToolbarPlugin {
        +render()
    }
    class ToolbarPlugin plugin
    
    class NodePickerPlugin {
        +render()
    }
    class NodePickerPlugin plugin

    %% --- Relationships ---
    %% Use longer dashes or thicker lines if supported, but standard syntax below
    ReactComponents ..> CanvasEngine : User Input
    
    CanvasContext *-- CanvasEngine : Owns
    CanvasContext *-- ConfigsManager : Owns
    
    CanvasEngine *-- ViewportManager : Controls
    CanvasEngine *-- EventBus : Uses
    
    ViewportManager ..> EventBus : Emits Updates

    BasePlugin <|-- NodeLayerPlugin : Extends
    BasePlugin <|-- GridPlugin : Extends
    BasePlugin <|-- MinimapPlugin : Extends
    BasePlugin <|-- ToolbarPlugin : Extends
    BasePlugin <|-- NodePickerPlugin : Extends
    
    CanvasContext o-- BasePlugin : Manages List
